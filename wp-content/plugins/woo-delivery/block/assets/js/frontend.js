const Coderockz_Woo_Delivery=({extensions:e,checkoutExtensionData:t,validation:o})=>{let a=e.coderockz_woo_delivery;if(a.has_virtual_downloadable_products)return null;let[l,r]=React.useState(a.order_type),[c,i]=React.useState(a.delivery_date),[d,n]=React.useState(a.delivery_time),[s,p]=React.useState(a.pickup_date),[m,k]=React.useState(a.pickup_time),[u,y]=React.useState(!1),{CHECKOUT_STORE_KEY:v}=wc.wcBlocksData,{useSelect:w}=wp.data,b=w(e=>e(v).isBeforeProcessing()),E=(e,t)=>{let l="coderockz_woo_"+t+"_error",r="This field is mandatory",c=!1;return("order_type"===t?(r=a.checkout_delivery_option_notice,c=a.enable_delivery_option):"delivery_date"===t?(r=a.checkout_date_notice,c=a.enable_delivery_date&&a.delivery_date_mandatory):"pickup_date"===t?(r=a.checkout_pickup_date_notice,c=a.enable_pickup_date&&a.pickup_date_mandatory):"delivery_time"===t?(r=a.checkout_time_notice,c=a.enable_delivery_time&&a.delivery_time_mandatory):"pickup_time"===t&&(r=a.checkout_pickup_time_notice,c=a.enable_pickup_time&&a.pickup_time_mandatory),!e&&c)?(o.setValidationErrors({[l]:{message:r,hidden:!1}}),!1):(o.clearValidationError(l),"order_type"===t&&("delivery"===e?(o.clearValidationError("coderockz_woo_pickup_date_error"),o.clearValidationError("coderockz_woo_pickup_time_error")):(o.clearValidationError("coderockz_woo_delivery_date_error"),o.clearValidationError("coderockz_woo_delivery_time_error"))),!0)};React.useEffect(()=>{b&&(a.enable_delivery_option&&E(l,"order_type"),a.enable_delivery_option?"delivery"===a.order_type?(E(c,"delivery_date"),E(d,"delivery_time")):"pickup"===a.order_type&&(E(s,"pickup_date"),E(m,"pickup_time")):(E(c,"delivery_date"),E(d,"delivery_time"),E(s,"pickup_date"),E(m,"pickup_time")))},[b]),React.useEffect(()=>{t.setExtensionData("coderockz-woo-delivery","order_type",l)},[l]),React.useEffect(()=>{t.setExtensionData("coderockz-woo-delivery","delivery_date",c)},[c]),React.useEffect(()=>{t.setExtensionData("coderockz-woo-delivery","delivery_time",d)},[d]),React.useEffect(()=>{t.setExtensionData("coderockz-woo-delivery","pickup_date",s)},[s]),React.useEffect(()=>{t.setExtensionData("coderockz-woo-delivery","pickup_time",m)},[m]),React.useEffect(()=>{i(a.delivery_date)},[a.delivery_date]),React.useEffect(()=>{n(a.delivery_time)},[a.delivery_time]),React.useEffect(()=>{p(a.pickup_date)},[a.pickup_date]),React.useEffect(()=>{k(a.pickup_time)},[a.pickup_time]);let f=w(e=>e(v).hasError());React.useEffect(()=>{f&&(a.delivery_time&&a.enable_delivery_time&&(!a.enable_delivery_option||"delivery"===a.order_type)&&!o.hasValidationErrors&&(n(null),E(null,"delivery_time"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_delivery_time_change",data:{delivery_time:null}}).finally(()=>y(!1))),a.pickup_time&&a.enable_pickup_time&&(!a.enable_delivery_option||"pickup"===a.order_type)&&!o.hasValidationErrors&&(k(null),E(null,"pickup_time"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_pickup_time_change",data:{pickup_time:null}}).finally(()=>y(!1))))},[f]);let z=e=>{let t=e.target.value;r(t),E(t,"order_type"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_order_type_change",data:{order_type:t}}).finally(()=>y(!1))},h=e=>{i(e),E(e,"delivery_date"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_delivery_date_change",data:{delivery_date:e}}).finally(()=>y(!1))},g=e=>{let t=e.target.value;n(t),E(t,"delivery_time"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_delivery_time_change",data:{delivery_time:t}}).finally(()=>y(!1))},_=e=>{p(e),E(e,"pickup_date"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_pickup_date_change",data:{pickup_date:e}}).finally(()=>y(!1))},C=e=>{let t=e.target.value;k(t),E(t,"pickup_time"),y(!0),wc.blocksCheckout.extensionCartUpdate({namespace:"coderockz_woo_delivery_pickup_time_change",data:{pickup_time:t}}).finally(()=>y(!1))};return React.createElement("div",{className:`coderockz-woo-delivery-block-container${u?" processing":""}`},React.createElement("legend",{className:"screen-reader-text"},a.delivery_option_field_label),React.createElement("div",{className:"wc-block-components-checkout-step__heading"},React.createElement("h2",{className:"wc-block-components-title wc-block-components-checkout-step__title",ariaHidden:!0},a.delivery_heading_checkout)),a.enable_delivery_option&&React.createElement(Coderockz_Woo_Order_Type,{settings:a,handleOrderTypeChange:z,validation:o}),a.enable_delivery_date&&(!a.enable_delivery_option||"delivery"===l)&&React.createElement(Coderockz_Woo_Delivery_Date,{settings:a,handleDeliveryDateChange:h,validation:o}),a.enable_delivery_time&&(!a.enable_delivery_option||"delivery"===l)&&React.createElement(Coderockz_Woo_Delivery_Time,{settings:a,handleDeliveryTimeChange:g,validation:o}),a.enable_pickup_date&&(!a.enable_delivery_option||"pickup"===l)&&React.createElement(Coderockz_Woo_Pickup_Date,{settings:a,handlePickupDateChange:_,validation:o}),a.enable_pickup_time&&(!a.enable_delivery_option||"pickup"===l)&&React.createElement(Coderockz_Woo_Pickup_Time,{settings:a,handlePickupTimeChange:C,validation:o}))},formattedDate=e=>{let t=e.getFullYear(),o=("0"+(e.getMonth()+1)).slice(-2),a=("0"+e.getDate()).slice(-2);return`${t}-${o}-${a}`},getEnableDates=(e,t,o,a)=>{e=parseInt(e);let l=[],r=new Date(t);for(;l.length<e;){let c=formattedDate(r);o.includes(r.getDay().toString())||a.includes(c)||l.push(c),r.setDate(r.getDate()+1)}return l},Coderockz_Woo_Order_Type=({settings:e,handleOrderTypeChange:t,validation:o})=>{let{delivery_options:a,order_type:l}=e,r=o.getValidationError("coderockz_woo_order_type_error"),c=()=>Object.entries(a).map(([e,t])=>React.createElement("option",{key:e,value:e,selected:l===e},t));return React.createElement("div",{className:`coderockz-woo-order-type-container${r?" has-error":""}`},React.createElement("div",{className:`wc-blocks-components-select coderockz-woo-delivery-select${l?"":" not-selected"}`},React.createElement("div",{className:"wc-blocks-components-select__container"},React.createElement("label",{htmlFor:"coderockz_woo_order_type",className:"wc-blocks-components-select__label"},e.delivery_option_field_label),React.createElement("select",{size:"1",name:"coderockz_woo_order_type",className:"wc-blocks-components-select__select",id:"coderockz_woo_order_type","aria-label":e.delivery_option_field_label,"aria-invalid":r?"true":"false",onChange:t,required:e.enable_delivery_option},React.createElement("option",{value:""},e.select_order_type_text),c()),React.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",className:"wc-blocks-components-select__expand","aria-hidden":"true",focusable:"false"},React.createElement("path",{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})))),r&&React.createElement("div",{className:"wc-block-components-validation-error",role:"alert"},React.createElement("p",{},r.message)))},Coderockz_Woo_Delivery_Date=({settings:e,handleDeliveryDateChange:t,validation:o})=>{let a=React.useRef(null),[l,r]=React.useState(!!e.delivery_date),c=o.getValidationError("coderockz_woo_delivery_date_error"),i=e.disable_week_days,d=[...e.disable_dates,...e.disable_delivery_date_passed_time,],n=getEnableDates(e.delivery_date_selectable_days,e.today,i,d),s=e.delivery_date_field_label;return e.delivery_date_mandatory||(s+=" (optional)"),React.useEffect(()=>{let o=flatpickr(a.current,{defaultDate:e.delivery_date,enable:n,minDate:e.today,dateFormat:"Y-m-d",altInput:!0,altFormat:e.delivery_date_format,locale:{firstDayOfWeek:e.week_starts_from},onChange(e,o,a){t(o)},onOpen(e,t,o){""===t?r(!1):r(!0)},onClose(e,t,o){""===t?r(!1):r(!0)}});return()=>{o&&o.destroy()}},[]),React.createElement("div",{className:`coderockz-woo-delivery-date-container${c?" has-error":""}`},React.createElement("div",{className:`wc-block-components-text-input coderockz-woo-delivery-text-input${l?" is-active":""}`},React.createElement("input",{ref:a,type:"text",name:"coderockz_woo_delivery_date",id:"coderockz_woo_delivery_date","aria-label":e.delivery_date_field_label,"aria-invalid":c?"true":"false",required:e.delivery_date_mandatory}),React.createElement("label",{className:"coderockz-woo-delivery-date-label",htmlFor:"coderockz_woo_delivery_date"},s)),c&&React.createElement("div",{className:"wc-block-components-validation-error",role:"alert"},React.createElement("p",{},c.message)))},Coderockz_Woo_Delivery_Time=({settings:e,handleDeliveryTimeChange:t,validation:o})=>{let a=React.useRef(null),{delivery_time_options:l,delivery_time:r}=e,c=o.getValidationError("coderockz_woo_delivery_time_error");React.useEffect(()=>{r||(a.current.selectedIndex=0)});let i=e.delivery_time_field_label;e.delivery_time_mandatory||(i+=" (optional)");let d=()=>Object.entries(l).map(([e,t])=>React.createElement("option",{key:e,value:e,selected:r===e&&!t.disabled,disabled:t.disabled},t.title));return React.createElement("div",{className:`coderockz-woo-delivery-time-container${c?" has-error":""}`},React.createElement("div",{className:`wc-blocks-components-select coderockz-woo-delivery-select${r?"":" not-selected"}`},React.createElement("div",{className:"wc-blocks-components-select__container"},React.createElement("label",{htmlFor:"coderockz_woo_delivery_time",className:"wc-blocks-components-select__label"},i),React.createElement("select",{ref:a,size:"1",name:"coderockz_woo_delivery_time",className:"wc-blocks-components-select__select",id:"coderockz_woo_delivery_time","aria-label":e.delivery_time_field_label,"aria-invalid":c?"true":"false",onChange:t,required:e.delivery_time_mandatory},React.createElement("option",{value:""},e.select_delivery_time_text),d()),React.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",className:"wc-blocks-components-select__expand","aria-hidden":"true",focusable:"false"},React.createElement("path",{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})))),c&&React.createElement("div",{className:"wc-block-components-validation-error",role:"alert"},React.createElement("p",{},c.message)))},Coderockz_Woo_Pickup_Date=({settings:e,handlePickupDateChange:t,validation:o})=>{let a=React.useRef(null),[l,r]=React.useState(!!e.pickup_date),c=o.getValidationError("coderockz_woo_pickup_date_error"),i=e.pickup_disable_week_days,d=[...e.pickup_disable_dates,...e.disable_pickup_date_passed_time,],n=getEnableDates(e.pickup_date_selectable_days,e.today,i,d),s=e.pickup_date_field_label;return e.pickup_date_mandatory||(s+=" (optional)"),React.useEffect(()=>{let o=flatpickr(a.current,{defaultDate:e.pickup_date,enable:n,minDate:e.today,dateFormat:"Y-m-d",altInput:!0,altFormat:e.pickup_date_format,locale:{firstDayOfWeek:e.pickup_week_starts_from},onChange(e,o,a){t(o)},onOpen(e,t,o){""===t?r(!1):r(!0)},onClose(e,t,o){""===t?r(!1):r(!0)}});return()=>{o&&o.destroy()}},[]),React.createElement("div",{className:`coderockz-woo-pickup-date-container${c?" has-error":""}`},React.createElement("div",{className:`wc-block-components-text-input coderockz-woo-delivery-text-input${l?" is-active":""}`},React.createElement("input",{ref:a,type:"text",name:"coderockz_woo_pickup_date",id:"coderockz_woo_pickup_date","aria-label":e.pickup_date_field_label,"aria-invalid":c?"true":"false",required:e.pickup_date_mandatory}),React.createElement("label",{className:"coderockz-woo-delivery-date-label",htmlFor:"coderockz_woo_pickup_date"},s)),c&&React.createElement("div",{className:"wc-block-components-validation-error",role:"alert"},React.createElement("p",{},c.message)))},Coderockz_Woo_Pickup_Time=({settings:e,handlePickupTimeChange:t,validation:o})=>{let a=React.useRef(null),{pickup_time_options:l,pickup_time:r}=e,c=o.getValidationError("coderockz_woo_pickup_time_error");React.useEffect(()=>{r||(a.current.selectedIndex=0)});let i=e.pickup_time_field_label;e.pickup_time_mandatory||(i+=" (optional)");let d=()=>Object.entries(l).map(([e,t])=>React.createElement("option",{key:e,value:e,selected:r===e&&!t.disabled,disabled:t.disabled},t.title));return React.createElement("div",{className:`coderockz-woo-pickup-time-container${c?" has-error":""}`},React.createElement("div",{className:`wc-blocks-components-select coderockz-woo-delivery-select${r?"":" not-selected"}`},React.createElement("div",{className:"wc-blocks-components-select__container"},React.createElement("label",{htmlFor:"coderockz_woo_pickup_time",className:"wc-blocks-components-select__label"},i),React.createElement("select",{ref:a,size:"1",name:"coderockz_woo_pickup_time",className:"wc-blocks-components-select__select",id:"coderockz_woo_pickup_time","aria-label":e.pickup_time_field_label,"aria-invalid":c?"true":"false",onChange:t,required:e.pickup_time_mandatory},React.createElement("option",{value:""},e.select_pickup_time_text),d()),React.createElement("svg",{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",className:"wc-blocks-components-select__expand","aria-hidden":"true",focusable:"false"},React.createElement("path",{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})))),c&&React.createElement("div",{className:"wc-block-components-validation-error",role:"alert"},React.createElement("p",{},c.message)))},coderockz_woo_delivery_metadata={apiVersion:3,name:"coderockz-woo-delivery",title:"Coderockz Woo Delivery",category:"woocommerce",icon:"calendar-alt",description:"Show delivery/pickup inputs in WooCommerce checkout block",supports:{multiple:!1},editorScript:"file:js/editor.js",viewStyle:["file:css/editor.css"],parent:[coderockz_woo_delivery_localize_settings.block_field_position],attributes:{lock:{type:"object",default:{remove:!0,move:!0}}}},coderockz_woo_delivery_options={metadata:coderockz_woo_delivery_metadata,component:Coderockz_Woo_Delivery};wc.blocksCheckout.registerCheckoutBlock(coderockz_woo_delivery_options);